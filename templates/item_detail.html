<h1>{{ item['title'] }}</h1>
<img src="{{ item['image'] }}" alt="{{ item['title'] }}" style="max-width: 300px;">
<p>Price: ${{ item['price'] }}</p>
<p>Description: {{ item['description'] }}</p>
<form>
    <button type="button" class="add-to-checkout-btn" data-item-id="{{ item_id }}">Add to Checkout</button>
</form>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const button = document.querySelector('.add-to-checkout-btn');
        button.addEventListener('click', function() {
            const itemId = this.getAttribute('data-item-id');

            fetch('/add_to_checkout', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ item_id: itemId })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    // Redirect directly to the home page with the query parameter
                    window.location.href = data.redirect_url;
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('An error occurred while adding to checkout.');
            });
        });
    });
</script>
